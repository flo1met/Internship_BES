getwd()
Sigma <- matrix(rep(0.2, 16), 4)
diag(Sigma) <- rep(1, 4)
mu <- c(1,2,3,4)
names(mu) <- c("mu1", "mu2", "mu3", "mu4")
Sigma <- matrix(rep(0.2, 16), 4)
diag(Sigma) <- rep(1, 4)
library(BFpack)
out <- BF(mu, Sigma = Sigma, n = 25, hypothesis = "mu1 > mu2 > mu3 > mu4")
out$PHP_exploratory
out$BFtu_exploratory
summary(out)
out$PHP_confirmatory
out$PHP_confirmatory[[2]]
out$BFtu_confirmatory
out$PHP_confirmatory[[2]]
1.043305641 / 1.043305641 +1
0.002694817 / 0.002694817 +1
0.002694817 / (0.002694817 +1)
1.043305641 / (1.043305641 +1)
mu <- c(1,2,3,4)
names(mu) <- c("mu1", "mu2", "mu3", "mu4")
Sigma <- matrix(rep(0.2, 16), 4)
diag(Sigma) <- rep(1, 4)
library(BFpack)
out <- BF(mu, Sigma = Sigma, n = 25, hypothesis = "mu1 < mu2 < mu3 < mu4")
out$BFtu_exploratory
summary(out)
out$PHP_confirmatory[[2]]
out$BFtu_confirmatory
out$PHP_confirmatory[[1]]
out$BFtu_confirmatory
out$BFtu_confirmatory[[1]]/(out$BFtu_confirmatory[[1]]+1)
mu <- c(1,2,3,4)
names(mu) <- c("mu1", "mu2", "mu3", "mu4")
Sigma <- matrix(rep(0.2, 16), 4)
diag(Sigma) <- rep(1, 4)
library(BFpack)
out <- BF(mu, Sigma = (Sigma/25), n = 25, hypothesis = "mu1 < mu2 < mu3 < mu4")
out$BFtu_exploratory
summary(out)
out$PHP_confirmatory[[1]]
out$BFtu_confirmatory
out$BFtu_confirmatory[[1]]/(out$BFtu_confirmatory[[1]]+1)
mu <- c(1,2,3,4)
names(mu) <- c("mu1", "mu2", "mu3", "mu4")
Sigma <- matrix(rep(0.2, 16), 4)
diag(Sigma) <- rep(1, 4)
library(BFpack)
out <- BF(mu, Sigma = (Sigma/250), n = 250, hypothesis = "mu1 < mu2 < mu3 < mu4")
out$BFtu_exploratory
summary(out)
out$PHP_confirmatory[[1]]
out$BFtu_confirmatory
out$BFtu_confirmatory[[1]]/(out$BFtu_confirmatory[[1]]+1)
mu <- c(1,2,3,4)
names(mu) <- c("mu1", "mu2", "mu3", "mu4")
Sigma <- matrix(rep(0.2, 16), 4)
diag(Sigma) <- rep(1, 4)
library(BFpack)
out <- BF(mu, Sigma = (Sigma/25), n = 25, hypothesis = "mu1 < mu2 < mu3 < mu4")
out$BFtu_exploratory
summary(out)
out$PHP_confirmatory[[1]]
out$BFtu_confirmatory
out$BFtu_confirmatory[[1]]/(out$BFtu_confirmatory[[1]]+1)
2.402810e+01/1.281258e-04
1.281258e-04/2.402810e+01
2.402810e+01/1.281258e-04
187535.2/(187535.2+1)
library(MASS)
library(tidyverse)
library(BFpack)
source("function.R")
set.seed(1337)
# Set Parameters
h_s1 <- "mu_s > mu_m"
h_s2 <- "mu_m > mu_f"
h_s3 <- "mu_f > mu_t"
H <- "mu_s > mu_m > mu_f > mu_t"
nsim <- 1
# Simulate Data Complete Hypothesis
t1 <- Sys.time()
data_comp <- simulate(nsim = nsim,
study = 3,
n_sample = c(25, 75, 50, 150, 100, 300, 500, 1500, 5000, 15000),
d = c(0, 0.2, 0.5, 0.8),
c = c(0, 0.2, 0.5, 0.8))
data_comp <- data_comp %>% # add hypotheses
mutate(H = H) %>% # compute BF
rowwise() %>%
mutate(BF_result = list(BF(x = s_mu,
Sigma = s_Sigma/n_sample,
n = n_sample,
hypothesis = H)),
BF1u = BF_result$BFtu_confirmatory[[1]],
PMP1c = BF_result$PHP_confirmatory[[1]]) %>%
select(-c(s_mu, s_Sigma, BF_result))
t2 <- Sys.time()
t2-t1 #4.9h
# Calculate PMPs
data_comp <-  data_comp %>%
mutate(PMP1u = BF1u/(BF1u + 1))
agg_comp <- data_comp %>%
group_by(d, c, n_sample, study) %>%
summarise(BF1u = mean(BF1u),
PMP1c = mean(PMP1c),
PMP1u = mean(PMP1u))
#save(data_comp, agg_comp, file = ".../data/data_comp_10k.RData")
#rm(data_comp, agg_comp)
# Simulate Data Partial Hypotheses
t1 <- Sys.time()
data_part <- simulate(nsim = nsim,
study = 1:3,
n_sample = c(25, 50, 100, 500, 5000),
d = c(0, 0.2, 0.5, 0.8),
c = c(0, 0.2, 0.5, 0.8))
data_part <- data_part %>% # add hypotheses
mutate(H = case_when(
study == 1 ~ h_s1,
study == 2 ~ h_s2,
study == 3 ~ h_s3)) %>% #compute BF
rowwise() %>%
mutate(BF_result = list(BF(x = s_mu,
Sigma = s_Sigma/n_sample,
n = n_sample,
hypothesis = H)),
BF1u = BF_result$BFtu_confirmatory[[1]],
PMP1c = BF_result$PHP_confirmatory[[1]]) %>%
select(-c(s_mu, s_Sigma, BF_result))
t2 <- Sys.time()
t2-t1 # 4h
# Calculate PMPs and do BES
data_part <- data_part %>%
mutate(PMP1u = BF1u/(BF1u + 1)) %>%
group_by(d,c, nsim, n_sample) %>%
mutate(BES_PMP1c = cumprod(PMP1c) / (cumprod(PMP1c) + cumprod(1-PMP1c)),
BES_PMP1u = cumprod(PMP1u) / (cumprod(PMP1u) + cumprod(1-PMP1u)))
agg_part <- data_part %>%
group_by(d, c, n_sample, study) %>%
summarise(BF1u = mean(BF1u),
PMP1c = mean(PMP1c),
PMP1u = mean(PMP1u),
BES_PMP1c = mean(BES_PMP1c),
BES_PMP1u = mean(BES_PMP1u))
#save(data_part, agg_part, file = ".../data/data_part_10k.RData")
#rm(data_part, agg_part)
View(data_part)
4e4 + 4e16
40000 + 160000
2e5
rnorm(2e5)
rnorm(1e6)
rnorm(1e7)
rnorm(1e8)
getwd()
library(MASS)
library(tidyverse)
library(BFpack)
source("function.R")
set.seed(1337)
# Set Parameters
h_s1 <- "mu_s > mu_m"
h_s2 <- "mu_f > mu_m"
h_s3 <- "mu_f > mu_t"
H <- "mu_s > mu_f > mu_m > mu_t"
nsim <- 1
# Simulate Data Complete Hypothesis
t1 <- Sys.time()
data_comp <- simulate(nsim = nsim,
study = 3,
n_sample = c(25, 75, 50, 150, 100, 300, 500, 1500, 5000, 15000),
d = c(0, 0.2, 0.5, 0.8),
c = c(0, 0.2, 0.5, 0.8))
data_comp <- data_comp %>% # add hypotheses
mutate(H = H) %>% # compute BF
rowwise() %>%
mutate(BF_result = list(BF(x = s_mu,
Sigma = s_Sigma/n_sample,
n = n_sample,
hypothesis = H)),
BF1u = BF_result$BFtu_confirmatory[[1]],
PMP1c = BF_result$PHP_confirmatory[[1]]) %>%
select(-c(s_mu, s_Sigma, BF_result))
t2 <- Sys.time()
t2-t1 #4.9h
# Calculate PMPs
data_comp <-  data_comp %>%
mutate(PMP1u = BF1u/(BF1u + 1))
agg_comp <- data_comp %>%
group_by(d, c, n_sample, study) %>%
summarise(BF1u = mean(BF1u),
PMP1c = mean(PMP1c),
PMP1u = mean(PMP1u))
save(data_comp, agg_comp, file = ".../data/data_comp_10k_switch_m_f.RData")
library(MASS)
library(tidyverse)
library(BFpack)
source("function.R")
set.seed(1337)
# Set Parameters
h_s1 <- "mu_s > mu_m"
h_s2 <- "mu_f > mu_m"
h_s3 <- "mu_f > mu_t"
H <- "mu_s > mu_f > mu_m > mu_t"
nsim <- 1
# Simulate Data Complete Hypothesis
t1 <- Sys.time()
data_comp <- simulate(nsim = nsim,
study = 3,
n_sample = c(25, 75, 50, 150, 100, 300, 500, 1500, 5000, 15000),
d = c(0, 0.2, 0.5, 0.8),
c = c(0, 0.2, 0.5, 0.8))
data_comp <- data_comp %>% # add hypotheses
mutate(H = H) %>% # compute BF
rowwise() %>%
mutate(BF_result = list(BF(x = s_mu,
Sigma = s_Sigma/n_sample,
n = n_sample,
hypothesis = H)),
BF1u = BF_result$BFtu_confirmatory[[1]],
PMP1c = BF_result$PHP_confirmatory[[1]]) %>%
select(-c(s_mu, s_Sigma, BF_result))
t2 <- Sys.time()
t2-t1 #4.9h
# Calculate PMPs
data_comp <-  data_comp %>%
mutate(PMP1u = BF1u/(BF1u + 1))
agg_comp <- data_comp %>%
group_by(d, c, n_sample, study) %>%
summarise(BF1u = mean(BF1u),
PMP1c = mean(PMP1c),
PMP1u = mean(PMP1u))
save(data_comp, agg_comp, file = "../data/data_comp_10k_switch_m_f.RData")
rm(data_comp, agg_comp)
# Simulate Data Partial Hypotheses
t1 <- Sys.time()
data_part <- simulate(nsim = nsim,
study = 1:3,
n_sample = c(25, 50, 100, 500, 5000),
d = c(0, 0.2, 0.5, 0.8),
c = c(0, 0.2, 0.5, 0.8))
data_part <- data_part %>% # add hypotheses
mutate(H = case_when(
study == 1 ~ h_s1,
study == 2 ~ h_s2,
study == 3 ~ h_s3)) %>% #compute BF
rowwise() %>%
mutate(BF_result = list(BF(x = s_mu,
Sigma = s_Sigma/n_sample,
n = n_sample,
hypothesis = H)),
BF1u = BF_result$BFtu_confirmatory[[1]],
PMP1c = BF_result$PHP_confirmatory[[1]]) %>%
select(-c(s_mu, s_Sigma, BF_result))
t2 <- Sys.time()
t2-t1 # 4h
# Calculate PMPs and do BES
data_part <- data_part %>%
mutate(PMP1u = BF1u/(BF1u + 1)) %>%
group_by(d,c, nsim, n_sample) %>%
mutate(BES_PMP1c = cumprod(PMP1c) / (cumprod(PMP1c) + cumprod(1-PMP1c)),
BES_PMP1u = cumprod(PMP1u) / (cumprod(PMP1u) + cumprod(1-PMP1u)))
agg_part <- data_part %>%
group_by(d, c, n_sample, study) %>%
summarise(BF1u = mean(BF1u),
PMP1c = mean(PMP1c),
PMP1u = mean(PMP1u),
BES_PMP1c = mean(BES_PMP1c),
BES_PMP1u = mean(BES_PMP1u))
save(data_part, agg_part, file = "../data/data_part_10k_switch_m_f.RData")
rm(data_part, agg_part)
<<<<<<< Updated upstream
getwd()
library(MASS)
library(tidyverse)
library(BFpack)
source("function.R")
set.seed(1337)
# Set Parameters
h_s1 <- "mu_s > mu_m"
h_s2 <- "mu_f > mu_m"
h_s3 <- "mu_f > mu_t"
H <- "mu_s > mu_f > mu_m > mu_t"
nsim <- 1e4
# Simulate Data Complete Hypothesis
t1 <- Sys.time()
data_comp <- simulate(nsim = nsim,
study = 3,
n_sample = c(25, 75, 50, 150, 100, 300, 500, 1500, 5000, 15000),
d = c(0, 0.2, 0.5, 0.8),
c = c(0, 0.2, 0.5, 0.8))
data_comp <- data_comp %>% # add hypotheses
mutate(H = H) %>% # compute BF
rowwise() %>%
mutate(BF_result = list(BF(x = s_mu,
Sigma = s_Sigma/n_sample,
n = n_sample,
hypothesis = H)),
BF1u = BF_result$BFtu_confirmatory[[1]],
PMP1c = BF_result$PHP_confirmatory[[1]]) %>%
select(-c(s_mu, s_Sigma, BF_result))
t2 <- Sys.time()
t2-t1 #4.9h
# Calculate PMPs
data_comp <-  data_comp %>%
mutate(PMP1u = BF1u/(BF1u + 1))
agg_comp <- data_comp %>%
group_by(d, c, n_sample, study) %>%
summarise(BF1u = mean(BF1u),
PMP1c = mean(PMP1c),
PMP1u = mean(PMP1u))
save(data_comp, agg_comp, file = "../data/data_comp_10k_switch_m_f.RData")
rm(data_comp, agg_comp)
# Simulate Data Partial Hypotheses
t1 <- Sys.time()
data_part <- simulate(nsim = nsim,
study = 1:3,
n_sample = c(25, 50, 100, 500, 5000),
d = c(0, 0.2, 0.5, 0.8),
c = c(0, 0.2, 0.5, 0.8))
data_part <- data_part %>% # add hypotheses
mutate(H = case_when(
study == 1 ~ h_s1,
study == 2 ~ h_s2,
study == 3 ~ h_s3)) %>% #compute BF
rowwise() %>%
mutate(BF_result = list(BF(x = s_mu,
Sigma = s_Sigma/n_sample,
n = n_sample,
hypothesis = H)),
BF1u = BF_result$BFtu_confirmatory[[1]],
PMP1c = BF_result$PHP_confirmatory[[1]]) %>%
select(-c(s_mu, s_Sigma, BF_result))
t2 <- Sys.time()
t2-t1 # 4h
# Calculate PMPs and do BES
data_part <- data_part %>%
mutate(PMP1u = BF1u/(BF1u + 1)) %>%
group_by(d,c, nsim, n_sample) %>%
mutate(BES_PMP1c = cumprod(PMP1c) / (cumprod(PMP1c) + cumprod(1-PMP1c)),
BES_PMP1u = cumprod(PMP1u) / (cumprod(PMP1u) + cumprod(1-PMP1u)))
agg_part <- data_part %>%
group_by(d, c, n_sample, study) %>%
summarise(BF1u = mean(BF1u),
PMP1c = mean(PMP1c),
PMP1u = mean(PMP1u),
BES_PMP1c = mean(BES_PMP1c),
BES_PMP1u = mean(BES_PMP1u))
save(data_part, agg_part, file = "../data/data_part_10k_switch_m_f.RData")
rm(data_part, agg_part)
library(MASS)
library(tidyverse)
library(BFpack)
source("function.R")
set.seed(1337)
# Set Parameters
h_s1 <- "mu_s > mu_m"
h_s2 <- "mu_m > mu_f"
h_s3 <- "mu_f > mu_t"
H <- "mu_s > mu_m > mu_f > mu_t"
nsim <- 1e4
# Simulate Data Complete Hypothesis
t1 <- Sys.time()
data_comp <- simulate(nsim = nsim,
study = 3,
n_sample = c(25, 75, 50, 150, 100, 300, 500, 1500, 5000, 15000),
d = c(0, 0.2, 0.5, 0.8),
c = c(0, 0.2, 0.5, 0.8))
data_comp <- data_comp %>% # add hypotheses
mutate(H = H) %>% # compute BF
rowwise() %>%
mutate(BF_result = list(BF(x = s_mu,
Sigma = s_Sigma/n_sample,
n = n_sample,
hypothesis = H)),
BF1u = BF_result$BFtu_confirmatory[[1]],
PMP1c = BF_result$PHP_confirmatory[[1]]) %>%
select(-c(s_mu, s_Sigma, BF_result))
t2 <- Sys.time()
t2-t1 #4.9h
# Calculate PMPs
data_comp <-  data_comp %>%
mutate(PMP1u = BF1u/(BF1u + 1))
agg_comp <- data_comp %>%
group_by(d, c, n_sample, study) %>%
summarise(BF1u = mean(BF1u),
PMP1c = mean(PMP1c),
PMP1u = mean(PMP1u))
save(data_comp, agg_comp, file = "../data/data_comp_10k.RData")
rm(data_comp, agg_comp)
# Simulate Data Partial Hypotheses
t1 <- Sys.time()
data_part <- simulate(nsim = nsim,
study = 1:3,
n_sample = c(25, 50, 100, 500, 5000),
d = c(0, 0.2, 0.5, 0.8),
c = c(0, 0.2, 0.5, 0.8))
data_part <- data_part %>% # add hypotheses
mutate(H = case_when(
study == 1 ~ h_s1,
study == 2 ~ h_s2,
study == 3 ~ h_s3)) %>% #compute BF
rowwise() %>%
mutate(BF_result = list(BF(x = s_mu,
Sigma = s_Sigma/n_sample,
n = n_sample,
hypothesis = H)),
BF1u = BF_result$BFtu_confirmatory[[1]],
PMP1c = BF_result$PHP_confirmatory[[1]]) %>%
select(-c(s_mu, s_Sigma, BF_result))
t2 <- Sys.time()
t2-t1 # 4h
# Calculate PMPs and do BES
data_part <- data_part %>%
mutate(PMP1u = BF1u/(BF1u + 1)) %>%
group_by(d,c, nsim, n_sample) %>%
mutate(BES_PMP1c = cumprod(PMP1c) / (cumprod(PMP1c) + cumprod(1-PMP1c)),
BES_PMP1u = cumprod(PMP1u) / (cumprod(PMP1u) + cumprod(1-PMP1u)))
agg_part <- data_part %>%
group_by(d, c, n_sample, study) %>%
summarise(BF1u = mean(BF1u),
PMP1c = mean(PMP1c),
PMP1u = mean(PMP1u),
BES_PMP1c = mean(BES_PMP1c),
BES_PMP1u = mean(BES_PMP1u))
save(data_part, agg_part, file = "../data/data_part_10k.RData")
rm(data_part, agg_part)
=======
complexity::complexity(3, 1,2,2,3)
complexity::complexity(2, 1,2)
complexity::complexity(4, 1,2,2,3, 3,4)
>>>>>>> Stashed changes
