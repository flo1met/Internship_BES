filter(study == 3 & n_sample %in% c(75, 150, 300, 1500), c == 0.2, d == 0.2) %>%
dplyr::select(n_sample, BES_PMP1u, nsim)
part_filtered <- data_part %>%
filter(study == 6 & n_sample != 5000, c == 0.2, d == 0.2) %>% ungroup %>%
dplyr::select(n_sample, BES_PMP1u, nsim)
part_filtered$n_sample <- part_filtered$n_sample*3
merged_data <- comp_filtered %>%
inner_join(part_filtered, by = c("n_sample", "nsim"), suffix = c("_comp", "_part"))
ggplot(merged_data, aes(sample = BES_PMP1u)) +
geom_qq(aes(sample = BES_PMP1u)) +
geom_qq_line(aes(sample = BES_PMP1u), color = "red") +
facet_wrap(~ n_sample) +
labs(x = "Quantiles Complete Hypothesis", y = "Quantiles Partial Hypotheses",
title = "Q-Q Plot: PMPs against unconstrained") +
theme_minimal()
# Boxplots
data_comp %>%
filter(study == 3, n_sample %in% c(75, 150, 300, 1500), c == 0.2, d == 0.2) %>%
ggplot(aes(x = as.factor(n_sample), y = BES_PMP1u)) +
stat_summary(aes(x = as.factor(n_sample), y = BES_PMP1u),
fun = mean,
geom = "line",
group = 1,
linewidth = 0.2) +
geom_boxplot(outlier.alpha = 0.3) +
#geom_hline(yintercept = 24/(24+1), color = "black", linetype = "dashed", alpha = 0.8) +
ylim(0, 1) +
labs(x = "Sample Size", y = "Posterior Model Probabilities") +
theme_minimal()
data_part %>%
filter(study == 6, n_sample != 5000, c == 0.2, d == 0.2) %>%
ggplot(aes(x = as.factor(n_sample), y = BES_PMP1u)) +
stat_summary(aes(x = as.factor(n_sample), y = BES_PMP1u),
fun = mean,
geom = "line",
group = 1,
linewidth = 0.2) +
geom_boxplot(outlier.alpha = 0.3) +
#geom_hline(yintercept = 8/(8+1), color = "black", linetype = "dashed", alpha = 0.8) +
ylim(0, 1) +
labs(x = "Sample Size (per Study)", y = "Posterior Model Probabilities") +
theme_minimal()
## QQ Plot
comp_filtered <- data_comp %>%
filter(study == 3 & n_sample %in% c(75, 150, 300, 1500), c == 0.2, d == 0.2) %>%
dplyr::select(n_sample, BES_PMP1u, nsim)
part_filtered <- data_part %>%
filter(study == 6 & n_sample != 5000, c == 0.2, d == 0.2) %>% ungroup %>%
dplyr::select(n_sample, BES_PMP1u, nsim)
part_filtered$n_sample <- part_filtered$n_sample*3
merged_data <- comp_filtered %>% ungroup() %>%
inner_join(part_filtered, by = c("n_sample", "nsim"), suffix = c("_comp", "_part"))
ggplot(merged_data, aes(sample = BES_PMP1u)) +
geom_qq(aes(sample = BES_PMP1u)) +
geom_qq_line(aes(sample = BES_PMP1u), color = "red") +
facet_wrap(~ n_sample) +
labs(x = "Quantiles Complete Hypothesis", y = "Quantiles Partial Hypotheses",
title = "Q-Q Plot: PMPs against unconstrained") +
theme_minimal()
View(merged_data)
## QQ Plot
comp_filtered <- data_comp %>%
filter(study == 3 & n_sample %in% c(75, 150, 300, 1500), c == 0.2, d == 0.2) %>%
dplyr::select(n_sample, BES_PMP1u, nsim)
part_filtered <- data_part %>%
filter(study == 6 & n_sample != 5000, c == 0.2, d == 0.2) %>% ungroup %>%
dplyr::select(n_sample, BES_PMP1u, nsim)
part_filtered$n_sample <- part_filtered$n_sample*3
merged_data <- comp_filtered %>%
inner_join(part_filtered, by = c("n_sample", "nsim"), suffix = c("_comp", "_part"))
ggplot(merged_data, aes(sample = BES_PMP1u_part)) +
geom_qq(aes(sample = BES_PMP1u_comp)) +
geom_qq_line(aes(sample = BES_PMP1u_comp), color = "red") +
facet_wrap(~ n_sample) +
labs(x = "Quantiles Complete Hypothesis", y = "Quantiles Partial Hypotheses",
title = "Q-Q Plot: PMPs against unconstrained") +
theme_minimal()
## QQ Plot
comp_filtered <- data_comp %>%
filter(study == 3 & n_sample %in% c(75, 150, 300, 1500), c == 0.2, d == 0.2) %>%
dplyr::select(n_sample, BES_PMP1u, nsim)
part_filtered <- data_part %>%
filter(study == 6 & n_sample != 5000, c == 0.2, d == 0.2) %>% ungroup %>%
dplyr::select(n_sample, BES_PMP1u, nsim)
part_filtered$n_sample <- part_filtered$n_sample*3
merged_data <- comp_filtered %>%
inner_join(part_filtered, by = c("n_sample", "nsim"), suffix = c("_comp", "_part"))
ggplot(merged_data, aes(sample = BES_PMP1u_part)) +
geom_qq(aes(sample = BES_PMP1u_comp)) +
geom_qq_line(aes(sample = BES_PMP1u_comp), color = "red") +
facet_wrap(~ n_sample) +
labs(x = "Quantiles Complete Hypothesis", y = "Quantiles Partial Hypotheses",
title = "Q-Q Plot: PMPs against unconstrained") +
theme_minimal()
## Raincloud Plots
data_comp %>%
filter(study == 6, n_sample %in% c(75, 150, 300, 1500), c == 0.2, d == 0.2) %>%
ggplot(aes(y = factor(n_sample), x = PMP1u, fill = factor(n_sample))) +
geom_boxplot(
width = 0.12,
# removing outliers
outlier.color = NA,
alpha = 0.5
) +
stat_dots(
# ploting on left side
side = "right",
# adjusting position
justification = 1.2,
# adjust grouping (binning) of observations
#binwidth = 0.25
alpha = 0.2
) +
# Themes and Labels
scale_fill_tq() +
theme_tq() +
labs(
title = "Complete Hypotheses: PMPs against unconstrained",
x = "PMP1u",
y = "Sample Size",
fill = "Sample Size"
) +
facet_wrap(~ n_sample, scales = "free") +
theme(
axis.ticks.y = element_blank(),
axis.text.y = element_blank())
## Raincloud Plots
data_comp %>%
filter(study == 6, n_sample %in% c(75, 150, 300, 1500), c == 0.2, d == 0.2) %>%
ggplot(aes(y = factor(n_sample), x = BES_PMP1u, fill = factor(n_sample))) +
geom_boxplot(
width = 0.12,
# removing outliers
outlier.color = NA,
alpha = 0.5
) +
stat_dots(
# ploting on left side
side = "right",
# adjusting position
justification = 1.2,
# adjust grouping (binning) of observations
#binwidth = 0.25
alpha = 0.2
) +
# Themes and Labels
scale_fill_tq() +
theme_tq() +
labs(
title = "Complete Hypotheses: PMPs against unconstrained",
x = "PMP1u",
y = "Sample Size",
fill = "Sample Size"
) +
facet_wrap(~ n_sample, scales = "free") +
theme(
axis.ticks.y = element_blank(),
axis.text.y = element_blank())
data_comp %>%
filter(study == 6, n_sample %in% c(75, 150, 300, 1500), c == 0.2, d == 0.2)
## Raincloud Plots
data_comp %>%
filter(study == 3, n_sample %in% c(75, 150, 300, 1500), c == 0.2, d == 0.2) %>%
ggplot(aes(y = factor(n_sample), x = BES_PMP1u, fill = factor(n_sample))) +
geom_boxplot(
width = 0.12,
# removing outliers
outlier.color = NA,
alpha = 0.5
) +
stat_dots(
# ploting on left side
side = "right",
# adjusting position
justification = 1.2,
# adjust grouping (binning) of observations
#binwidth = 0.25
alpha = 0.2
) +
# Themes and Labels
scale_fill_tq() +
theme_tq() +
labs(
title = "Complete Hypotheses: PMPs against unconstrained",
x = "PMP1u",
y = "Sample Size",
fill = "Sample Size"
) +
facet_wrap(~ n_sample, scales = "free") +
theme(
axis.ticks.y = element_blank(),
axis.text.y = element_blank())
data_part %>%
filter(study == 6, n_sample != 5000, c == 0.2, d == 0.2) %>%
ggplot(aes(y = factor(n_sample), x = BES_PMP1u, fill = factor(n_sample))) +
geom_boxplot(
width = 0.12,
# removing outliers
outlier.color = NA,
alpha = 0.5
) +
stat_dots(
# ploting on left side
side = "right",
# adjusting position
justification = 1.2,
# adjust grouping (binning) of observations
#binwidth = 0.25
alpha = 0.2
) +
# Themes and Labels
scale_fill_tq() +
theme_tq() +
labs(
title = "Partial Hypotheses: PMPs against unconstrained",
x = "PMP1u",
y = "Sample Size",
fill = "Sample Size"
) +
facet_wrap(~ n_sample, scales = "free") +
theme(
axis.ticks.y = element_blank(),
axis.text.y = element_blank())
## Raincloud Plots
data_comp %>%
filter(study == 3, n_sample %in% c(75, 150, 300, 1500), c == 0.2, d == 0.2) %>%
ggplot(aes(y = factor(n_sample), x = BES_PMP1u, fill = factor(n_sample))) +
geom_boxplot(
width = 0.12,
# removing outliers
outlier.color = NA,
alpha = 0.5
) +
stat_dots(
# ploting on left side
side = "right",
# adjusting position
justification = 1.2,
# adjust grouping (binning) of observations
#binwidth = 0.25
alpha = 0.2
) +
# Themes and Labels
scale_fill_tq() +
theme_tq() +
labs(
title = "Complete Hypotheses: PMPs against unconstrained",
x = "PMP1u",
y = "Sample Size",
fill = "Sample Size"
) +
facet_wrap(~ n_sample, scales = "free") +
theme(
axis.ticks.y = element_blank(),
axis.text.y = element_blank())
data_part %>%
filter(study == 6, n_sample != 5000, c == 0.2, d == 0.2) %>%
ggplot(aes(y = factor(n_sample), x = BES_PMP1u, fill = factor(n_sample))) +
geom_boxplot(
width = 0.12,
# removing outliers
outlier.color = NA,
alpha = 0.5
) +
stat_dots(
# ploting on left side
side = "right",
# adjusting position
justification = 1.2,
# adjust grouping (binning) of observations
#binwidth = 0.25
alpha = 0.2
) +
# Themes and Labels
scale_fill_tq() +
theme_tq() +
labs(
title = "Partial Hypotheses: PMPs against unconstrained",
x = "PMP1u",
y = "Sample Size",
fill = "Sample Size"
) +
facet_wrap(~ n_sample, scales = "free") +
theme(
axis.ticks.y = element_blank(),
axis.text.y = element_blank())
# Lineplot
agg_part_filt <- agg_part %>% filter(study == 6 & n_sample != 5000)
agg_part_filt$n_sample <- agg_part_filt$n_sample*3
agg_comp_filt <- agg_comp %>% filter(n_sample %in% c(75, 150, 300, 1500))
aggRes <- left_join(agg_part_filt, agg_comp_filt, by = c("d", "c", "n_sample"))
aggRes %>% ggplot() +
geom_line(aes(x = as.factor(n_sample), y = PMP1c.y, linetype = "Complete", color = as.factor(d), group = 1)) +
geom_line(aes(x = as.factor(n_sample), y = BES_PMP1c, linetype = "Partial", color = as.factor(d), group = 1)) +
scale_linetype_manual(name = "Hypothesis", values = c("Complete" = "solid", "Partial" = "longdash")) +
labs(x = "Effect Size", y = "Correlation") +
scale_color_discrete(guide = "none") +
theme_bw() +
facet_grid(c~ d) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
aggRes %>% ggplot() +
geom_line(aes(x = as.factor(n_sample), y = BES_PMP1c.y, linetype = "Complete", color = as.factor(d), group = 1)) +
geom_line(aes(x = as.factor(n_sample), y = BES_PMP1c.x, linetype = "Partial", color = as.factor(d), group = 1)) +
scale_linetype_manual(name = "Hypothesis", values = c("Complete" = "solid", "Partial" = "longdash")) +
labs(x = "Effect Size", y = "Correlation") +
scale_color_discrete(guide = "none") +
theme_bw() +
facet_grid(c~ d) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
agg_comp_filt <- agg_comp %>% filter(study == 3 & n_sample %in% c(75, 150, 300, 1500))
aggRes <- left_join(agg_part_filt, agg_comp_filt, by = c("d", "c", "n_sample"))
aggRes %>% ggplot() +
geom_line(aes(x = as.factor(n_sample), y = BES_PMP1c.y, linetype = "Complete", color = as.factor(d), group = 1)) +
geom_line(aes(x = as.factor(n_sample), y = BES_PMP1c.x, linetype = "Partial", color = as.factor(d), group = 1)) +
scale_linetype_manual(name = "Hypothesis", values = c("Complete" = "solid", "Partial" = "longdash")) +
labs(x = "Effect Size", y = "Correlation") +
scale_color_discrete(guide = "none") +
theme_bw() +
facet_grid(c~ d) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Boxplots
data_comp %>%
filter(study == 3, n_sample %in% c(75, 150, 300, 1500), c == 0.2, d == 0.2) %>%
ggplot(aes(x = as.factor(n_sample), y = PMP1c)) +
stat_summary(aes(x = as.factor(n_sample), y = PMP1c),
fun = mean,
geom = "line",
group = 1,
linewidth = 0.2) +
geom_boxplot(outlier.alpha = 0.3) +
ylim(0, 1) +
labs(x = "Sample Size", y = "Posterior Model Probabilities") +
theme_minimal()
data_part %>%
filter(study == 6, n_sample != 5000, c == 0.2, d == 0.2) %>%
ggplot(aes(x = as.factor(n_sample), y = BES_PMP1c)) +
stat_summary(aes(x = as.factor(n_sample), y = BES_PMP1c),
fun = mean,
geom = "line",
group = 1,
linewidth = 0.2) +
geom_boxplot(outlier.alpha = 0.3) +
ylim(0, 1) +
labs(x = "Sample Size (per Study)", y = "Posterior Model Probabilities") +
theme_minimal()
## QQ plot
comp_filtered <- data_comp %>%
filter(study == 3 & n_sample %in% c(75, 150, 300, 1500), c == 0.2, d == 0.2) %>%
dplyr::select(n_sample, BES_PMP1c, nsim)
part_filtered <- data_part %>%
filter(study == 6 & n_sample != 5000, c == 0.2, d == 0.2) %>% ungroup %>%
dplyr::select(n_sample, BES_PMP1c, nsim)
part_filtered$n_sample <- part_filtered$n_sample*3
merged_data <- comp_filtered %>%
inner_join(part_filtered, by = c("n_sample", "nsim"), suffix = c("_comp", "_part"))
ggplot(merged_data, aes(sample = BES_PMP1c_part)) +
geom_qq(aes(sample = PMP1c_comp)) +
geom_qq_line(aes(sample = PMP1c_comp), color = "red") +
facet_wrap(~ n_sample) +
labs(x = "Quantiles Complete Hypothesis", y = "Quantiles Partial Hypotheses",
title = "Q-Q Plot: PMPs against complement") +
theme_minimal()
ggplot(merged_data, aes(sample = BES_PMP1c_part)) +
geom_qq(aes(sample = BES_PMP1c_comp)) +
geom_qq_line(aes(sample = BES_PMP1c_comp), color = "red") +
facet_wrap(~ n_sample) +
labs(x = "Quantiles Complete Hypothesis", y = "Quantiles Partial Hypotheses",
title = "Q-Q Plot: PMPs against complement") +
theme_minimal()
## Raincloud Plots
data_comp %>%
filter(study == 3, n_sample %in% c(75, 150, 300, 1500), c == 0.2, d == 0.2) %>%
ggplot(aes(y = factor(n_sample), x = PMP1c, fill = factor(n_sample))) +
geom_boxplot(
width = 0.12,
# removing outliers
outlier.color = NA,
alpha = 0.5
) +
stat_dots(
# ploting on left side
side = "right",
# adjusting position
justification = 1.2,
# adjust grouping (binning) of observations
#binwidth = 0.25
alpha = 0.2
) +
# Themes and Labels
scale_fill_tq() +
theme_tq() +
labs(
title = "Complete Hypothesis: PMPs against complement",
x = "PMP1c",
y = "Sample Size",
fill = "Sample Size"
) +
facet_wrap(~ n_sample, scales = "free") +
theme(
axis.ticks.y = element_blank(),
axis.text.y = element_blank())
data_part %>%
filter(study == 6, n_sample != 5000, c == 0.2, d == 0.2) %>%
ggplot(aes(y = factor(n_sample), x = BES_PMP1c, fill = factor(n_sample))) +
geom_boxplot(
width = 0.12,
# removing outliers
outlier.color = NA,
alpha = 0.5
) +
stat_dots(
# ploting on left side
side = "right",
# adjusting position
justification = 1.2,
# adjust grouping (binning) of observations
#binwidth = 0.25
alpha = 0.2
) +
# Themes and Labels
scale_fill_tq() +
theme_tq() +
labs(
title = "Partial Hypotheses: PMPs against complement",
x = "PMP1c",
y = "Sample Size",
fill = "Sample Size"
) +
facet_wrap(~ n_sample, scales = "free") +
theme(
axis.ticks.y = element_blank(),
axis.text.y = element_blank())
## Raincloud Plots
data_comp %>%
filter(study == 3, n_sample %in% c(75, 150, 300, 1500), c == 0.2, d == 0.2) %>%
ggplot(aes(y = factor(n_sample), x = BES_PMP1c, fill = factor(n_sample))) +
geom_boxplot(
width = 0.12,
# removing outliers
outlier.color = NA,
alpha = 0.5
) +
stat_dots(
# ploting on left side
side = "right",
# adjusting position
justification = 1.2,
# adjust grouping (binning) of observations
#binwidth = 0.25
alpha = 0.2
) +
# Themes and Labels
scale_fill_tq() +
theme_tq() +
labs(
title = "Complete Hypothesis: PMPs against complement",
x = "PMP1c",
y = "Sample Size",
fill = "Sample Size"
) +
facet_wrap(~ n_sample, scales = "free") +
theme(
axis.ticks.y = element_blank(),
axis.text.y = element_blank())
data_part %>%
filter(study == 6, n_sample != 5000, c == 0.2, d == 0.2) %>%
ggplot(aes(y = factor(n_sample), x = BES_PMP1c, fill = factor(n_sample))) +
geom_boxplot(
width = 0.12,
# removing outliers
outlier.color = NA,
alpha = 0.5
) +
stat_dots(
# ploting on left side
side = "right",
# adjusting position
justification = 1.2,
# adjust grouping (binning) of observations
#binwidth = 0.25
alpha = 0.2
) +
# Themes and Labels
scale_fill_tq() +
theme_tq() +
labs(
title = "Partial Hypotheses: PMPs against complement",
x = "PMP1c",
y = "Sample Size",
fill = "Sample Size"
) +
facet_wrap(~ n_sample, scales = "free") +
theme(
axis.ticks.y = element_blank(),
axis.text.y = element_blank())
load("../data/data_comp_2500.RData")
load("../data/data_part_2500.RData")
library(tidyverse)
library(ggplot2)
library(ggdist)
library(ggthemes)
library(tidyquant)
load("../data/data_comp_2500_switch_m_f.RData")
load("../data/data_part_2500_switch_m_f.RData")
library(tidyverse)
library(ggplot2)
library(ggdist)
library(ggthemes)
library(tidyquant)
data_part$BES_PMP1c[data_part$BF1c == Inf] <- 1 # set BES_PMP1c to 1 when BF1c is Inf, as this creates NaN
findNaN <- data_part %>% filter(BES_PMP1c == "NaN")
View(findNaN)
